syntax = "proto3";
package clientpb;
option go_package = "github.com/longzekun/specter/protobuf/clientpb";

message MTLSListenerReq {
  string Host = 1;
  uint32 Port = 2;
}

message ListenerJob {
  string ID = 1;
  string Type = 2;
  uint32 JobID = 3;
  MTLSListenerReq MTLSConf = 4;
}

message Event {
  uint32 EventType = 1;
  client Client = 2;
}

message Operator {
  bool Online = 1;
  string Name = 2;
}

message client {
  string ID = 1;
  string Name  = 2;
  Operator Operator = 3;
}

message version {
  string Version = 1;
  string Commit = 2;
  string Dirty = 3;
  string CompiledAt = 4;
  string OS = 5;
  string Arch = 6;
}

message Job {
  int32 ID = 1;
  string Name = 2;
  string Description = 3;
  string Protocol = 4;
  int32 Port = 5;
}

message Jobs {
  repeated Job Activate = 1;
}

message KillJobReq{
  uint32 ID = 1;
}

message Session {
  string ID=1;
  string Name = 2;
  string Hostname = 3;
  string Username = 4;
  string UUID = 5;
  string UID = 6;
  string GID = 7;
  string OS = 8;
  string Version = 9;
  string Arch = 10;
  string PID = 11;
  string Filename = 12;
  string RemoteAddress = 13;
  string TransportType = 14;
  int64 LastMessageTime = 15;
  bool Health = 16;
}

message Sessions {
  repeated Session Sessions = 1;
}

message KillReq {
  string SessionID = 1;
}